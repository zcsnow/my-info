<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" >
<!--<meta name="viewport" content="user-scalable=no, width=640">-->
	<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">
<title>全新BMW M2锋芒上市</title>

<script>
/*  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-72255351-17', 'auto');
  ga('send', 'pageview');
*/
</script>
<script>
	/*var ua = navigator.userAgent.toLowerCase();
	if(ua.indexOf('iphone')==-1 && ua.indexOf('android')==-1){
		location.href = 'pc.html';
	}*/
</script>
<style>
html,
body {
	margin:0;
	height:100%;
	background:#fff;
}

.video-wrapper {
	position: relative;
	height:100%;
	overflow:hidden;
}
.video-responsive {
	position: relative;
	width: 100%;
	/*height:1040px;*/
	height:100%;
}
.canvas,
.video {
	/*height: 1040px;*/
	left: 0;
	position: absolute;
	top: 0;
	width: 100%;
	height:100%;
	background: #000;
	z-index: 5;
	cursor: pointer;
}


@-webkit-keyframes loading {
	to {
		background-position-x:-10200px;
	}
}

#masker {
	position:absolute;
	left:0;
	top:0;
	width:100%;
	height:100%;
	overflow:auto;
	z-index:50;
}
/*#link {
	display:none;
	position:absolute;
	left:0;
	top:0;
	width:100%;
	height:100%;
	overflow:hidden;
	background:url(over.jpg) no-repeat;
	z-index:45;
}
#btn {
	position:absolute;
	left:50%;
	top:860px;
	margin-left:-210px;
	width:200px;
	height:80px;
	z-index:50;
}
#btn1 {
	position:absolute;
	left:50%;
	top:860px;
	margin-left:10px;
	width:200px;
	height:80px;
	z-index:50;
}
*/

</style>

</head>
<body>
<!--<div id="loading">
	<div id="load1"></div>
	<div id="load2"></div>
	<div id="load3"></div>
	<div id="load4"></div>
	<div id="load5"></div>
</div>-->
<div id="masker">
	<img src="masker.jpg" width="100%" alt="">
</div>
<div id="link">
	<a href="javascript:;" data-href="http://www.bmw.com.cn/cn_mobi/zh/insights/events/pool/m2/gigi/overview.html" id="btn"></a>
	<a href="javascript:;" data-href="http://www.bmw.com.cn/cn_mobi/zh/insights/events/pool/m2/registration_standalone.html?channel=m_wechat" id="btn1"></a>
</div>
<div class="video-wrapper js-video-wrapper">
	<div class="video-responsive">
		<video class="video js-video" webkit-playsinline muted>
			<source src="final.mp4" type="video/mp4">
		</video>
		<canvas class="canvas js-canvas"></canvas>
		<div class="video-timeline js-timeline">
			<div class="video-timeline-passed js-timeline-passed">
			</div>
		</div>
	</div>
</div>
<script src="jquery.min.js"></script>
<!--<script src="hammer.min.js"></script>
<script src="jquery.hammer.js"></script>
<script src="jquery.transit.min.js"></script>-->
<script src="canvas-video-player.js"></script>
<script>
	var isIphone = navigator.userAgent.toLowerCase().indexOf('iphone') >= 0;
	// var sound = document.createElement('audio');
	var ld=vd=0;
	// sound.src = 'media/sound.mp3';
	//playOver();	
	if (isIphone) {
	    var canvasVideo = new CanvasVideoPlayer({
			videoSelector: '.js-video',
			canvasSelector: '.js-canvas',
			hideVideo: true,
			audio: true,
		});
	}else {
		vd = 1;
	    $('canvas').hide();
	    $('.video').remove();
	    $('.video-responsive').append('<video src="final.mp4" id="video" width="0" height="0" style="background:transparent;"></video>')

		$('#video').get(0).load();
		// $('#video').get(0).play();
		$('#video').get(0).addEventListener('canplaythrough',function(){
			
	    })

	    $('#video').on('ended',function(){
	    	showBtn();
	    	$('#video').remove();
	    })

	}
	
	function showBtn(){
		//$('#link').show();
	}

	/*$('#masker').hammer().on('panup',function(e){
		//上滑
		var y = e.gesture.distance;
		// console.log(y)
		if(y>180){
			y = 180;
		}
		$('#masker>img').css({y:-y});
	})*/
	$('#masker').on('touchend',function(){
		//$('#masker>img').transition({y:0},300,function(){
			$('#masker').fadeOut();
			
		//});
		if(canvasVideo){
			canvasVideo.play();
		}else{
			$('#video').width(640).height(1040).get(0).play();
		}
	})

	/*$('#link a').on('touchend',function(){
		var href = $(this).data('href');
		location.href = href;
	})*/
	// $('#loading').on('touchend',function(){
	// 	location.reload(true);
	// })

	document.addEventListener('touchmove',function(e){
		e.preventDefault();
	})
</script>

</body>
</html>
